<!DOCTYPE html>
<html th:lang="${#locale.language}" th:dir="#{language.direction}" th:data-language="${#locale.toString()}"
  xmlns:th="https://www.thymeleaf.org">

<head>
  <th:block th:insert="~{fragments/common :: head(title=#{compress.title}, header=#{compress.header})}"></th:block>
  <meta name="description" th:content="#{compress.metaDescription}">
  <link rel="stylesheet" href="/css/compress-modern.css">
</head>

<body>
  <th:block th:insert="~{fragments/common :: game}"></th:block>
  <div id="page-container">
    <div id="content-wrap">
      <th:block th:insert="~{fragments/navbar.html :: navbar}"></th:block>
      <br><br>
      <!-- Hero Section -->
      <div class="hero-section bg-gradient py-5">
        <div class="container">
          <div class="row justify-content-center text-center">
            <div class="col-lg-8">
              <div class="hero-content">
                <div class="hero-icon mb-3">
                  <span class="material-symbols-rounded display-1 text-primary">compress</span>
                </div>
                <h1 class="display-4 fw-bold mb-3" th:text="#{compress.header}">PDF Compress</h1>
                <p class="lead text-muted mb-4" th:text="#{compress.seoDescription}">Efficiently compress your PDF files to reduce size while maintaining document quality.</p>
                <div class="hero-stats d-flex justify-content-center gap-4 mb-4">
                  <div class="stat-item">
                    <div class="stat-number h4 text-primary mb-0">90%</div>
                    <div class="stat-label small text-muted">Size Reduction</div>
                  </div>
                  <div class="stat-item">
                    <div class="stat-number h4 text-primary mb-0">100%</div>
                    <div class="stat-label small text-muted">Quality Preserved</div>
                  </div>
                  <div class="stat-item">
                    <div class="stat-number h4 text-primary mb-0">0</div>
                    <div class="stat-label small text-muted">Files Stored</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Main Tool Section -->
      <div class="container py-5">
        <div class="row justify-content-center">
          <div class="col-xl-8">
            <form action="#" th:action="@{'/api/v1/misc/compress-pdf'}" method="post" enctype="multipart/form-data" class="compress-form">
              
              <!-- Step 1: File Upload -->
              <div class="tool-step mb-5">
                <div class="step-header d-flex align-items-center mb-3">
                  <div class="step-number">1</div>
                  <h2 class="h4 mb-0 ms-3">Upload Your PDF</h2>
                </div>
                <div class="upload-zone">
                  <div th:replace="~{fragments/common :: fileSelector(name='fileInput', multipleInputsForSingleRequest=false, accept='application/pdf')}"></div>
                </div>
              </div>

              <!-- Step 2: Compression Settings -->
              <div class="tool-step mb-5">
                <div class="step-header d-flex align-items-center mb-4">
                  <div class="step-number">2</div>
                  <h2 class="h4 mb-0 ms-3">Choose Compression Level</h2>
                </div>
                
                <div class="compression-options">
                  <!-- Compression Level Selector -->
                  <div class="option-card active" data-level="balanced">
                    <div class="option-header d-flex justify-content-between align-items-center">
                      <div class="d-flex align-items-center">
                        <input type="radio" name="compressionMode" value="balanced" id="balanced" class="form-check-input me-3" checked>
                        <div>
                          <h3 class="h5 mb-1">Balanced Compression</h3>
                          <p class="text-muted small mb-0">Best balance between size and quality</p>
                        </div>
                      </div>
                      <div class="compression-badge">
                        <span class="badge bg-primary">Recommended</span>
                      </div>
                    </div>
                  </div>

                  <div class="option-card" data-level="maximum">
                    <div class="option-header d-flex justify-content-between align-items-center">
                      <div class="d-flex align-items-center">
                        <input type="radio" name="compressionMode" value="maximum" id="maximum" class="form-check-input me-3">
                        <div>
                          <h3 class="h5 mb-1">Maximum Compression</h3>
                          <p class="text-muted small mb-0">Smallest file size, slight quality reduction</p>
                        </div>
                      </div>
                      <div class="compression-indicator">
                        <span class="text-success small">Up to 90% smaller</span>
                      </div>
                    </div>
                  </div>

                  <div class="option-card" data-level="custom">
                    <div class="option-header d-flex justify-content-between align-items-center">
                      <div class="d-flex align-items-center">
                        <input type="radio" name="compressionMode" value="custom" id="custom" class="form-check-input me-3">
                        <div>
                          <h3 class="h5 mb-1">Custom Settings</h3>
                          <p class="text-muted small mb-0">Fine-tune compression parameters</p>
                        </div>
                      </div>
                    </div>
                    
                    <!-- Custom Settings Panel -->
                    <div class="custom-settings mt-3" style="display: none;">
                      <div class="row g-3">
                        <div class="col-md-6">
                          <label for="optimizeLevel" class="form-label">Optimization Level</label>
                          <select name="optimizeLevel" id="optimizeLevel" class="form-select">
                            <option value="1">1 - Minimal compression</option>
                            <option value="2">2 - Light compression</option>
                            <option value="3">3 - Low compression</option>
                            <option value="4">4 - Medium-low compression</option>
                            <option value="5" selected>5 - Balanced compression</option>
                            <option value="6">6 - Medium-high compression</option>
                            <option value="7">7 - High compression</option>
                            <option value="8">8 - Very high compression</option>
                            <option value="9">9 - Maximum compression</option>
                          </select>
                        </div>
                        <div class="col-md-6">
                          <label for="expectedOutputSize" class="form-label">Target Size (optional)</label>
                          <input type="text" name="expectedOutputSize" id="expectedOutputSize" class="form-control" placeholder="e.g., 2MB">
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Step 3: Additional Options -->
              <div class="tool-step mb-5">
                <div class="step-header d-flex align-items-center mb-3">
                  <div class="step-number">3</div>
                  <h2 class="h4 mb-0 ms-3">Additional Options</h2>
                </div>
                
                <div class="additional-options">
                  <div class="option-toggle">
                    <div class="form-check form-switch">
                      <input class="form-check-input" type="checkbox" name="grayscale" id="grayscaleCheck" value="true">
                      <label class="form-check-label" for="grayscaleCheck">
                        <div class="option-info">
                          <div class="option-title">Convert to Grayscale</div>
                          <div class="option-description text-muted small">Convert color images to grayscale for additional compression</div>
                        </div>
                      </label>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Action Button -->
              <div class="text-center">
                <button type="submit" id="submitBtn" class="btn btn-primary btn-lg px-5 py-3">
                  <span class="material-symbols-rounded me-2">compress</span>
                  Compress PDF
                </button>
                <p class="text-muted small mt-2 mb-0">Your file will be processed securely and deleted after download</p>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Features Section -->
      <div class="features-section py-5 bg-light">
        <div class="container">
          <div class="row">
            <div class="col-lg-4 text-center mb-4">
              <div class="feature-item">
                <div class="feature-icon mb-3">
                  <span class="material-symbols-rounded display-6 text-primary">security</span>
                </div>
                <h3 class="h5">Secure Processing</h3>
                <p class="text-muted">Files are processed locally and automatically deleted after compression</p>
              </div>
            </div>
            <div class="col-lg-4 text-center mb-4">
              <div class="feature-item">
                <div class="feature-icon mb-3">
                  <span class="material-symbols-rounded display-6 text-primary">speed</span>
                </div>
                <h3 class="h5">Fast Compression</h3>
                <p class="text-muted">Advanced algorithms ensure quick processing without quality loss</p>
              </div>
            </div>
            <div class="col-lg-4 text-center mb-4">
              <div class="feature-item">
                <div class="feature-icon mb-3">
                  <span class="material-symbols-rounded display-6 text-primary">high_quality</span>
                </div>
                <h3 class="h5">Quality Preserved</h3>
                <p class="text-muted">Smart compression maintains document readability and visual quality</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <th:block th:insert="~{fragments/footer.html :: footer}"></th:block>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Handle compression option selection
      const optionCards = document.querySelectorAll('.option-card');
      const customSettings = document.querySelector('.custom-settings');
      const radioButtons = document.querySelectorAll('input[name="compressionMode"]');
      
      // Set default compression level based on mode
      const optimizeLevelSelect = document.getElementById('optimizeLevel');
      
      function updateCompressionLevel(mode) {
        switch(mode) {
          case 'balanced':
            optimizeLevelSelect.value = '5';
            break;
          case 'maximum':
            optimizeLevelSelect.value = '8';
            break;
          case 'custom':
            // Keep current selection
            break;
        }
      }
      
      // Handle option card clicks
      optionCards.forEach(card => {
        card.addEventListener('click', function() {
          const radio = this.querySelector('input[type="radio"]');
          const mode = radio.value;
          
          // Remove active class from all cards
          optionCards.forEach(c => c.classList.remove('active'));
          
          // Add active class to clicked card
          this.classList.add('active');
          
          // Check the radio button
          radio.checked = true;
          
          // Update compression level
          updateCompressionLevel(mode);
          
          // Show/hide custom settings
          if (mode === 'custom') {
            customSettings.style.display = 'block';
            customSettings.classList.add('show');
          } else {
            customSettings.style.display = 'none';
            customSettings.classList.remove('show');
          }
        });
      });
      
      // Handle radio button changes (for keyboard navigation)
      radioButtons.forEach(radio => {
        radio.addEventListener('change', function() {
          const card = this.closest('.option-card');
          const mode = this.value;
          
          // Remove active class from all cards
          optionCards.forEach(c => c.classList.remove('active'));
          
          // Add active class to parent card
          card.classList.add('active');
          
          // Update compression level
          updateCompressionLevel(mode);
          
          // Show/hide custom settings
          if (mode === 'custom') {
            customSettings.style.display = 'block';
            customSettings.classList.add('show');
          } else {
            customSettings.style.display = 'none';
            customSettings.classList.remove('show');
          }
        });
      });
      
      // Initialize default state
      const defaultRadio = document.querySelector('input[name="compressionMode"]:checked');
      if (defaultRadio) {
        updateCompressionLevel(defaultRadio.value);
      }
      
      // Add smooth scrolling for better UX
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute('href'));
          if (target) {
            target.scrollIntoView({
              behavior: 'smooth',
              block: 'start'
            });
          }
        });
      });
      
      // Add file upload feedback
      const fileInput = document.querySelector('input[type="file"]');
      if (fileInput) {
        fileInput.addEventListener('change', function() {
          const uploadZone = document.querySelector('.upload-zone');
          if (this.files.length > 0) {
            uploadZone.style.borderColor = 'var(--bs-success)';
            uploadZone.style.backgroundColor = 'rgba(25, 135, 84, 0.05)';
          }
        });
      }
    });
  </script>
</body>

</html>
